@startuml component-backend
!include  https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

' C4 Component diagram for backend database and file storage.

Container(management, "User and Data Management Layer (API)")
Container(auth, "Authentication") {
  Component(user_info, "Information on users", $descr="Metadata on registered users of the Data Resource")
}

Container_Boundary(bee, "Backend Environment") {
  Container_Boundary(rdb_metadata, "Relational Database for Metadata") {
    Component(changelog, "Changelog in Tables", $descr="Changes made to the data")
    ' TODO: Not sure what to do about these.
    ' Component(data_dictionary, "Resource data dictionary", "the data dictionary unique to the data Resource")
    ' Component(cdm_data, "Common Data Models", "pre-loaded data dictionaries from common data models")
  }
  Container_Boundary(rdb_data, "Relational Database for Data") {
    Component(dt, "Data in Tables", $descr="Data from Data Resource entered into database")
    ' TODO: Not sure what to do about these.
    ' Component(data_dictionary, "Resource data dictionary", "the data dictionary unique to the data Resource")
    ' Component(cdm_data, "Common Data Models", "pre-loaded data dictionaries from common data models")
    ' Component(schema, "Schema Metadata", "Schema data pre-loaded?")
  }
  Container_Boundary(fs, "File storage") {
    Component(raw_file, "File storage", $descr="For uploaded raw data files")
  }
}

Rel(management, raw_file, "Write data")

Rel(management, dt, "Write and read")
BiRel(management, changelog, "Write and read table with changes made")

Rel(raw_file, dt, "Process and insert")

BiRel(user_info, management, "Fetch permissions")

@enduml
