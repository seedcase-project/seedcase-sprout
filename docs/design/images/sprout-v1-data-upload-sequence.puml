@startuml sprout-v1-data-upload-sequence

title Sprout-v1: Data Upload from Existing Schema

participant "User" as u
participant "Front end" as f
participant "API" as api
participant "Backend" as b

f -> u: User selects "Upload Data based on Existing Schema"
u -> f: User selects existing schema from dropdown and file to upload (csv).\nThey click "Upload data"
f -> api: System transfers data and ID of selected schema
api -> b: System transfers ID of selected schema 
b -> api: System retrieves existing schema
api -> api: System validates\nby comparing data to schema

group Validation error (data does not match schema)
    api --> f: System sends back error "Upload failed"\n with information on where they don't match.
    note right of f
        This could be a system endpoint.
        Alternatively, User could be given the option to
        "Cancel Upload" or "Correct Upload(?)"
    end note
end
group Validation success (data matches schema)
    api -> b: System posts data upload with "Completed" flag
    b -> b : System creates record\nand saves data upload
    b -> api: System confirms data upload
    api -> f: System retrieves confirmation
    f -> u: System displays confirmation
end

@enduml
